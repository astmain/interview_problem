<meta charset="UTF-8">
<title>https://bbs.tampermonkey.net.cn/thread-896-1-1.html</title>
<script class="jq" src="https://code.jquery.com/jquery-3.0.0.min.js"></script>
<script class="vue" src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
<script class="element" src="https://unpkg.com/element-ui/lib/index.js"></script>
<link class="element" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css" rel="stylesheet">
<script class="axios" src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script class="函数延迟" src="../函数延迟.js"></script>

<body>
  <DD id="root">


    <br></br>

    <el-button type="primary" size="mini" @click="方法_111_发请求()">方法_111_发请求</el-button>

    <br></br>
    <el-button type="primary" size="mini" @click="方法_222_李恒道原生方法()">方法_222_李恒道原生方法</el-button>

    <br></br>
    <el-button type="primary" size="mini" @click="方法_333_改写成await()">方法_333_改写成await</el-button>




  </DD>
  <!-- -------------------------------------------------------------------------------------------------- -->
  <script>
    var obj = {}; let ppp = {}; let jq = $; let url = "http://120.25.224.61:9001/word_01_middle?user_id=234578&word_long=" + "我的你的鞋子"
    let app = new Vue({
      el: " #root ",
      data: {

      },
      methods: {

        async 方法_111_发请求() {
          // let res = await axios.get(url)
          // console.log('方法_111=>一:', res.data)
          fetch(url)
            .then(function (response) {
              return response.json();
            })
            .then(function (myJson) {
              console.log("方法_111_发请求", myJson);
            });


        },//-


        async 方法_222_李恒道原生方法() {
          let oldfetch = fetch
          function newobj() { }
          function fuckfetch(...bianliang) {
            return new Promise(function (resolve, reject) {
              oldfetch(...bianliang).then(function (response) {
                let tagetobk = new newobj();
                tagetobk.oldfetch = response;

                let handler = {
                  get: function (target, prop, receiver) {

                    if (prop === 'oldfetch') {


                      console.log('111=>一1:', target, "类型", typeof (target))



                      console.log('111=>一2:', prop)

                      return Reflect.get(target, prop);
                    }
                    if (typeof Reflect.get(target.oldfetch, prop) === 'function') {
                      if (Reflect.get(target.oldfetch, prop + 'proxy') === undefined) {
                        target.oldfetch[prop + 'proxy'] = new Proxy(Reflect.get(target.oldfetch, prop), {
                          apply: function (target, thisArg, argumentsList) {


                            console.log('222=>一1:', target)
                            console.log('222=>一2:', thisArg)
                            console.log('222=>一3:', argumentsList)
                            return Reflect.apply(target, thisArg.oldfetch, argumentsList);
                          }
                        });

                      }
                      return Reflect.get(target.oldfetch, prop + 'proxy')
                    }
                    return Reflect.get(target.oldfetch, prop);
                  },

                  // set(target, prop, value) {
                  //   console.log('set', target, prop, value)
                  //   return Reflect.set(target.oldfetch, prop, value);
                  // },
                };
                let proxy = new Proxy(tagetobk, handler)
                resolve(proxy)
              })

            });
          }

          window.fetch = fuckfetch


        },//-


        async 方法_333() {
          let oldfetch = fetch
          function newobj() { }
          function fuckfetch(...bianliang) {
            return new Promise(function (resolve, reject) {
              oldfetch(...bianliang).then(function (response) {
                let tagetobk = new newobj();
                tagetobk.oldfetch = response;

                let handler = {
                  get: function (target, prop, receiver) {

                    if (prop === 'oldfetch') {


                      console.log('111=>一1:', target, "类型", typeof (target))



                      console.log('111=>一2:', prop)

                      return Reflect.get(target, prop);
                    }
                    if (typeof Reflect.get(target.oldfetch, prop) === 'function') {
                      if (Reflect.get(target.oldfetch, prop + 'proxy') === undefined) {
                        target.oldfetch[prop + 'proxy'] = new Proxy(Reflect.get(target.oldfetch, prop), {
                          apply: function (target, thisArg, argumentsList) {


                            console.log('222=>一1:', target)
                            console.log('222=>一2:', thisArg)
                            console.log('222=>一3:', argumentsList)
                            return Reflect.apply(target, thisArg.oldfetch, argumentsList);
                          }
                        });

                      }
                      return Reflect.get(target.oldfetch, prop + 'proxy')
                    }
                    return Reflect.get(target.oldfetch, prop);
                  },

                  // set(target, prop, value) {
                  //   console.log('set', target, prop, value)
                  //   return Reflect.set(target.oldfetch, prop, value);
                  // },
                };
                let proxy = new Proxy(tagetobk, handler)
                resolve(proxy)
              })

            });
          }

          window.fetch = fuckfetch


        },//-



      }
    })
  </script>
</body>